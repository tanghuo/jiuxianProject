<?php if (!defined('THINK_PATH')) exit(); var_dump($_POST); echo "<br/>"; var_dump($_FILES); echo "<br/>"; try{ $user="root"; $pass="123456789"; $PDO=new PDO("mysql:host=localhost;dbname=jiuxian",$user,$pass); $PDO->setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION ); $PDO->beginTransaction(); $query = "select * from noticeinfo where Info_id=?" ; $PDOD = $PDO->prepare($query) ; $PDOD -> bindParam(1, $temp_id) ; $temp_id = chkID($_POST["originate"]) ; $PDOD -> execute(); echo "var<br/>"; if(!($PDOD->fetchAll(PDO::FETCH_ASSOC))){ $query="insert noticeinfo values(?,?)"; $PDO2=$PDO->prepare($query); $PDO2->bindParam(1, $info_id); $PDO2->bindParam(2, $info_detail); $info_id=chkID($_POST["originate"]); $info_detail=$_POST["info_detail"]; $PDO2 -> execute(); echo "success1"; } else { $query="UPDATE noticeinfo set Info_detail=? where Info_id=?"; $PDO2=$PDO->prepare($query); $PDO2->bindParam(1, $info_detail); $PDO2->bindParam(2, $Info_id); $Info_id=chkID($_POST["originate"]); $info_detail=$_POST["info_detail"]; $PDO2 -> execute(); echo "success2"; } $PDO->commit(); } catch(PDOException $e){ print "Error!: " . $e->getMessage() . "<br/>"; } function chkID($in){ switch ($in) { case "adv2_noticeInfo": $i=0; if($_POST["wordNum_1"]==(++$i)){ return $i; } if($_POST["wordNum_1"]==(++$i)){ return $i; } if($_POST["wordNum_1"]==(++$i)){ return $i; } if($_POST["wordNum_1"]==(++$i)){ return $i; } if($_POST["wordNum_1"]==(++$i)){ return $i; } if($_POST["wordNum_1"]==(++$i)){ return $i; } break; case "adv2_saleInfo": $i=0; $base=10; if($_POST["wordNum_1"]==(++$i)){ return $base+$i; } if($_POST["wordNum_1"]==(++$i)){ return $base+$i; } if($_POST["wordNum_1"]==(++$i)){ return $base+$i; } if($_POST["wordNum_1"]==(++$i)){ return $base+$i; } if($_POST["wordNum_1"]==(++$i)){ return $base+$i; } if($_POST["wordNum_1"]==(++$i)){ return $base+$i; } break; } } ?>